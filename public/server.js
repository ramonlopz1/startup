const express=require("express"),app=express(),mongoose=require("mongoose"),dotenv=require("dotenv"),bodyParser=require("body-parser"),path=require("path"),engines=require("consolidate"),session=require("express-session"),userRoute=require("./routes/user"),authRoute=require("./routes/auth"),productRoute=require("./routes/product"),cartRoute=require("./routes/cart"),orderRoute=require("./routes/order"),painelRoute=require("./routes/painel");dotenv.config(),app.set("views",path.join(__dirname,"/view")),app.engine("html",engines.mustache),app.set("view engine","html"),mongoose.connect(process.env.MONGO_URL).then((()=>{console.log("DB Connection successfull")})).catch((e=>{console.log(e)})),app.get("/",((e,r)=>r.render("index.html"))),app.get("/login",((e,r)=>r.render("login.html"))),app.get("/register",((e,r)=>r.render("register.html"))),app.use(bodyParser.urlencoded({extended:!0})),app.use(express.json()),app.use(express.static(".")),app.use(session({secret:process.env.JWT_SEC,saveUninitialized:!1,resave:!1})),app.use("/api/auth",authRoute),app.use("/api/users",userRoute),app.use("/api/products",productRoute),app.use("/api/carts",cartRoute),app.use("/api/orders",orderRoute),app.use("/api/painel",painelRoute),app.listen(process.env.PORT||5e3,(()=>{console.log("Backend server is running.")}));